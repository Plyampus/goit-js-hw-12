{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport { refs, value, showLoader, currentPage, pageLimit} from \"../main\";\n\nconst myAxios = axios.create ({\n    baseURL: \"https://pixabay.com/api/\",\n})\n\nexport async function getImages() {\n    const params = {\n        key: \"3539379-d64fd5a5897018ff1512b690c\",\n        q: value,\n        per_page: pageLimit,\n        page: currentPage,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: \"true\",\n    };\n\n    showLoader();\n\n    const response = await myAxios.get(\"\", { params })\n    return response.data;\n};\n\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { refs, lightbox, displayMessage } from '../main';\n\n\nexport function imagesTemplate(data) {\n    if (data.hits.length === 0) {\n        displayMessage(\n        'Sorry, there are no images matching your search query. Please try again!'\n        );\n    } else {\n        const images = data.hits;\n\n        const markup = images.map(image => \n            `<li class=\"gallery-item\">\n                <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n                <img loading=\"lazy\" class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n                </a>\n                <div class=\"stats\">\n                    <p class=\"text\"><span class=\"text__span\">likes</span><br/>${image.likes}</p>\n                    <p class=\"text\"><span class=\"text__span\">Views</span><br/>${image.views}</p>\n                    <p class=\"text\"><span class=\"text__span\">Coments</span><br/>${image.comments}</p>\n                    <p class=\"text\"><span class=\"text__span\">Dowloads</span><br/>${image.downloads}</p>\n                </div>\n            </li>`).join('');\n\n    refs.gallery.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n    }\n}\n","import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { getImages } from \"./js/pixabay-api.js\";\nimport { imagesTemplate } from \"./js/render-functions.js\";\n\n\nexport const lightbox = new SimpleLightbox('.gallery-link', {\n    captionsData: \"alt\",\n    captionDelay: 250,\n});\n\nexport const refs = {\n    form: document.querySelector(\".form\"),\n    searchInput: document.getElementById(\"searchInput\"),\n    searchBtn: document.querySelector(\"button\"),\n    loadBtn: document.querySelector(\".load-more-button\"),\n    loader: document.querySelector(\".loader\"),\n    gallery: document.querySelector(\".gallery\"),\n}\n\n\nexport let value = \"\";\nexport let currentPage = 1;\nexport let pageLimit = 15;\nexport let totalHits = 0;\n\nhideLoader();\nhideLoadBtn();\n\nfunction isOnline() {\n    return window.navigator.onLine;\n};\n\nlet messageDisplayed = false; // Declare the flag here\n\nrefs.form.addEventListener(\"submit\", async event => {\n    event.preventDefault();\n    currentPage = 1;\n    refs.gallery.innerHTML = \"\";\n    value = refs.searchInput.value.trim();\n    messageDisplayed = false; // Reset the flag here\n    if (value !== '') {\n        if (!isOnline()) {\n            displayMessage(\"Internet connection is lost. Please check your connection.\");\n            return;\n        }\n        try {\n            const data = await getImages(value, currentPage);\n            totalHits = data.totalHits;\n            const maxPage = Math.ceil(totalHits / pageLimit);\n            imagesTemplate(data);\n            hideLoader();\n            if (currentPage >= maxPage) {\n                hideLoadBtn();\n            } else {\n                showLoadBtn();\n            }\n        } catch (error) {\n            console.log(error);\n            displayMessage(\"An error occurred while fetching data.\");\n            hideLoadBtn();\n        }\n    } else {\n        displayMessage(\"Empty field!\");\n        hideLoadBtn();\n    }\n    refs.form.reset();\n});\nrefs.loadBtn.addEventListener(\"click\", async onLoadMoreClick => {\n    if (currentPage * pageLimit >= totalHits) {\n        if (!messageDisplayed) {\n            displayMessage(\"No more images to load.\");\n            messageDisplayed = true;\n        }\n        return;\n    }\n    currentPage += 1;\n    try {\n        const data = await getImages(value, currentPage);\n        hideLoader();\n        imagesTemplate(data);\n        showLoadBtn();\n        const item = document.querySelector(\".gallery-item\");\n        const rect = item.getBoundingClientRect();\n        window.scrollBy({\n            top: rect.height * 2,\n            behavior: \"smooth\",\n        })\n        const maxPage = Math.ceil(totalHits / pageLimit);\n        if (currentPage >= maxPage) {\n            hideLoadBtn();\n        }\n    } catch (error) {\n        console.log(error);\n        displayMessage(\"An error occurred while fetching data.\");\n        hideLoadBtn();\n    }\n});\n\n\nexport function displayMessage(message) {\n    if (message === \"No more images to load.\" && messageDisplayed) {\n        return;\n    }\n    iziToast.error({\n        title: '',\n        message: message,\n        position: \"topRight\",\n        backgroundColor: \"red\",\n    });\n\n    if (message === \"No more images to load.\") {\n        messageDisplayed = true;\n    }\n}\n\nexport function hideLoader() {\n    refs.loader.style.display = \"none\";\n}\n\nexport function showLoader() {\n    refs.loader.style.display = \"block\";\n}\n\nfunction hideLoadBtn() {\n    refs.loadBtn.style.display = \"none\";\n}\n\nfunction showLoadBtn() {\n    refs.loadBtn.style.display = \"block\";\n}\n\nwindow.addEventListener('scroll', () => {\n    if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {\n        if (currentPage * pageLimit >= totalHits && !messageDisplayed) {\n            displayMessage(\"No more images to load.\");\n            messageDisplayed = true;\n            return;\n        }\n    }\n});\n"],"names":["myAxios","axios","getImages","params","value","pageLimit","currentPage","showLoader","imagesTemplate","data","displayMessage","markup","image","refs","lightbox","SimpleLightbox","totalHits","hideLoader","hideLoadBtn","isOnline","messageDisplayed","event","maxPage","showLoadBtn","error","onLoadMoreClick","rect","message","iziToast"],"mappings":"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"}